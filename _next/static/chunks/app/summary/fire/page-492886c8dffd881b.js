(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2718],{2199:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var n=r(5155),i=r(7746),o=r(4865),a=r(8145),s=r(7168),l=r(8482),c=r(4950),d=r(1058),u=r(7797),f=r(5695),p=r(2115),v=r(6671);let m=["Engine","Truck","Rescue","Medic","Chief"];function g(){let[e,t]=(0,p.useState)(null),[r,g]=(0,p.useState)(""),h=(0,f.useRouter)(),x=e=>e.includes("Police")||e.includes("State")||e.includes("Sheriff"),S=(0,p.useCallback)((e,t)=>{let r=(0,u.g1)(t),n=(null==r?void 0:r.fdRunOrder)||[];return e.sort((e,t)=>{var r,i;let o=x(e),a=x(t);if(o&&!a)return 1;if(!o&&a)return -1;if(o&&a)return 0;let s=m.some(t=>e.includes(t))||/\d+/.test(e),l=m.some(e=>t.includes(e))||/\d+/.test(t);if(s&&!l)return -1;if(!s&&l)return 1;if(!s&&!l)return 0;let c=(null==(r=e.match(/\d+/))?void 0:r[0])||"",d=(null==(i=t.match(/\d+/))?void 0:i[0])||"",u=n.indexOf(c),f=n.indexOf(d);if(-1!==u&&-1!==f&&u!==f)return u-f;if(-1===u&&-1!==f)return 1;if(-1!==u&&-1===f)return -1;let p=m.findIndex(t=>e.includes(t)),v=m.findIndex(e=>t.includes(e));return -1!==p&&-1!==v?p-v:-1===p&&-1!==v?1:-1!==p&&-1===v?-1:0})},[]);(0,p.useEffect)(()=>{let e=localStorage.getItem("DISPATCH_HISTORY");if(e){let r=JSON.parse(e);Array.isArray(r)?t(r[r.length-1]):t(r)}},[]);let b=(0,p.useCallback)(()=>{let t=(0,c.g)((null==e?void 0:e.buildingInfo)||"");return t?t.cids:"Not Available"},[null==e?void 0:e.buildingInfo]);function N(){navigator.clipboard.writeText(r).then(()=>{v.o.success("Case Created",{description:"Call created, creating dispatch for POLICE"});let t={postal:(null==e?void 0:e.postal)||"",buildingInfo:(null==e?void 0:e.buildingInfo)||"",street:(null==e?void 0:e.street)||"",crossStreet1:(null==e?void 0:e.crossStreet1)||"",crossStreet2:(null==e?void 0:e.crossStreet2)||"",callerNumber:(null==e?void 0:e.callerNumber)||"",callerName:(null==e?void 0:e.callerName)||"",callerStatement:(null==e?void 0:e.callerStatement)||"",service:"Police",fromOther:!0};localStorage.setItem("NEW_CALL",JSON.stringify(t)),h.push("/create-call/police")})}return(0,p.useEffect)(()=>{if(e){var t,r;let n=e.units?S([...e.units],e.postal):[],i=null==(t=(0,u.g1)(e.postal))?void 0:t.twp;g(["Code: ".concat(e.code),"".concat(e.boxType?"Box: ".concat(e.boxType," Box ").concat(null==(r=(0,u.g1)(e.postal))?void 0:r.fireBox):""),"Location: ".concat(e.postal," ").concat(e.street).concat(i?", ".concat(i):"").concat(e.buildingInfo?" - ".concat(e.buildingInfo):""),"Cross: ".concat(e.crossStreet1||"N/A"," / ").concat(e.crossStreet2||"N/A"),"Recc: ".concat(function(e){let t=d.Zh.find(t=>t.id===e);return t?t.units.map(e=>{let t=e.type;return"Ambulance"===t?t="Transport (BLS)":"Medic"===t?t="Transport (ALS)":"AMR 400 Series (BLS)"===t?t="Transport (BLS)":"AMR 600 Series (ALS)"===t?t="Transport (ALS)":"AMR 800 Series (ACLS"===t&&(t="Transport (ACLS)"),"".concat(e.quantity,"x ").concat(t)}).join(", "):"None"}(e.plan)),"Disp: ".concat(n.join(", ")||"None"),"Problem: ".concat(e.complaint," - ").concat(e.codeText),"Caller Statement: ".concat(e.callerStatement),"==============================","Scene Status: ".concat((null==e?void 0:e.notSecure)?"Not Secure":"Secure"),"Scene Com: Not Established","Channel: Fire Response","Staging Location: N/A","CIDS: "+b(),"==============================","ProQA Information:",e.reconfigured?"-- Call reconfigured from ".concat(e.reconfigured):"",!(null==e?void 0:e.proqaAnswers)||(null==e?void 0:e.isOverriden)?"-- ProQA Override":[...(e.proqaAnswers||[]).filter(e=>!e.omit).map(e=>"-- ".concat(e.answer))],"ProQA completed by: Dispatcher ".concat(localStorage.getItem("CALLSIGN")||"UNKNOWN")].flat().filter(Boolean).join("\n"))}},[e,S,b]),e?(0,n.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,n.jsx)(o.A,{}),(0,n.jsx)("main",{className:"flex-1 flex justify-center py-8",children:(0,n.jsx)("div",{className:"container space-y-4",children:(0,n.jsxs)(l.Zp,{children:[(0,n.jsx)(l.aR,{children:(0,n.jsxs)(l.ZB,{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{children:"Dispatch Summary"}),(0,n.jsx)(a.E,{variant:"outline",className:"font-mono",children:e.complaint})]})}),(0,n.jsxs)(l.Wu,{className:"space-y-2",children:[(0,n.jsx)("textarea",{value:r,onChange:e=>g(e.target.value),className:"w-full min-h-[500px] font-mono text-sm p-4 border rounded-lg resize-none auto-expand",style:{resize:"none"},spellCheck:!1}),(0,n.jsx)("div",{className:"flex justify-end space-x-2 pt-4",children:(0,n.jsx)(s.$,{className:"cursor-pointer",variant:"destructive",onClick:()=>e.tandem&&"EMS"===e.service?N():void(e&&navigator.clipboard.writeText(r).then(()=>{var t;if((null==(t=d.Zh.find(t=>t.id===(null==e?void 0:e.plan)))?void 0:t.sendPolice)===!0&&!e.fromPolice)return N();v.o.success("Case Created",{description:"Dispatch summary has been copied"});let r=JSON.parse(localStorage.getItem("PREFERENCES")||"{}");if(r&&r.soundEffects){let e=new Audio("/audio/Dispatch.mp3");e.play(),e.volume=.5}localStorage.removeItem("NEW_CALL"),localStorage.removeItem("FIRE_DATA"),window.dispatchEvent(new CustomEvent("dispatch-storage-update")),h.push("/dispatch")}).catch(e=>{console.error("Failed to copy:",e),v.o.error("Failed to copy",{description:"Could not copy to clipboard"})})),children:e.tandem&&"EMS"===e.service?"Continue":"Complete Case"})})]})]})})}),(0,n.jsx)(i.A,{})]}):(0,n.jsx)("div",{children:"Loading..."})}},4044:(e,t,r)=>{Promise.resolve().then(r.bind(r,2199))},8145:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var n=r(5155);r(2115);var i=r(9708),o=r(2085),a=r(3999);let s=(0,o.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,asChild:o=!1,...l}=e,c=o?i.Slot:"span";return(0,n.jsx)(c,{"data-slot":"badge",className:(0,a.cn)(s({variant:r}),t),...l})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4619,6580,6671,8045,1058,7797,6528,8441,1684,7358],()=>t(4044)),_N_E=e.O()}]);